# SQL
## 演習問題1 (商品を購入したときに必要なテーブルを作成。)
- 商品をみかん5とりんご10を購入した場合、何も考えずに1テーブルと1レコードで表示する以下になります。
  

    |注文番号|商品名A|値段A|購入数A|商品名B|値段B|購入数B|合計金額(税込)|
    |---|---|---|---|---|---|---|---|
    |1| みかん|100|5|りんご|200|10|2750|

    </br>別商品を買えば買うほど列にカラムが追加されます。
    </br>商品だけを直す
    </br>別商品をどんだけ買うかはお客様次第なので、それを予測して1テーブルにカラムを設定することは不可能です。

    <br> また別の人が同じ商品を買った場合

    |注文番号|商品名A|値段A|購入数A|商品名B|値段B|購入数B|合計金額(税込)|
    |---|---|---|---|---|---|---|---|
    |1| みかん|100|5|りんご|200|10|2750|
    |2| みかん|100|5|りんご|200|10|2750|

  　</br>このように全く同じ商品情報を複数テーブルに持たしてしまいます。
  　</br>みかんの商品名が変わったときに、みかんと表記されたデータを複数件直す必要があります。
    </br>上記の例だとデータ管理するのに工数がかかってしまうため、
  　</br>似たような重複カラムをなくす、必要な情報に必要なカラムを整理することを正規化と言います。
    <br>以下で正規化について書かれたサイトがあるの参考にしてください
 　 </br>url:https://oss-db.jp/dojo/dojo_info_04
    </br>リレーショナルデータベースの考え方も必要なので以下を読んでください    　　　　</br>url:https://proglearn.com/2020/08/13/%E3%80%901%E5%AF%BE%E5%A4%9A%EF%BC%9F%E3%80%91%E4%BB%8A%E6%9B%B4%E8%81%B4%E3%81%91%E3%81%AA%E3%81%84%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E3%83%AA%E3%83%AC%E3%83%BC%E3%82
    </br>youtubeでいろんな方が説明されてますので色々とググってみてください。

    </br>商品を扱うテーブルと注文書を扱うテーブルで分けましょう

### 商品のテーブルを作成してください<br>
  Create文は以下を参考に学んでください<br>
  url:https://www.javadrive.jp/mysql/table/index1.html <br>
    
- 商品の扱うデータのイメージ<br>
  商品のデータを扱うイメージ以下になります。
    |id|商品名|値段|
    |---|---|---|
    |1|みかん|100|
    |2|リンゴ|200|


- テーブル名はproductsで以下の内容で作成 <br>
    |論理名|物理名|型|備考|
    |---|---|---|---|
    | id |  id  |  int | 主キーを設定<br>AUTO_INCREMENTで自動採番してください |
    |名前| 商品名|  varchar(50)  | not null で　null値を入れないように設定 |
    |価格(税抜)| price | int |-|
    |税率| tax | int |-|
    
    
### 注文テーブルを作成してください<br>
- 注文を扱うデータのイメージ<br>
  注文のデータを扱うイメージ以下になります。 
    |id(注文番号)|購入者|購入時間|商品ID|数量|商品ID|数量|合計金額|
    |---|---|---|---|---|---|---|---|
    |1|社長|2023/07/02|1|5|2|10|2750|

    </br>商品に関する情報は外だしできましたが
    </br>これだと似たようなカラムが存在します。
  　</br>商品を誰がいつ購入したかの情報と購入した商品の情報を別で管理することで、管理しやすくなります。
　　</br>注文のテーブルと注文明細テーブルを作ります。

- 注文を扱うデータのイメージ

    |id(注文番号)|購入者|購入時間|合計金額(税抜)|合計金額(税込)
    |---|---|---|---|---|
    |1|社長|2023/07/02|2500|2750|

- 注文明細を扱うデータのイメージ

    |id(注文の明細番号)|注文番号|商品のID|数量|価格|
    |---|---|---|---|---|
    |1|1|1|5|500|
    |2|1|2|10|2000|

<br>イメージがついてから作成してください

- 注文テーブル名をordersで以下の内容で作成<br>

    |論理名|物理名|型|備考|
    |---|---|---|---|
    | 注文番号 |  id  |  int | 主キーを設定<br>AUTO_INCREMENTで自動採番 |
    |購入者| name|  varchar(20) | not null で　null値を入れないよう |
    |購入日| time | datetime | not null で　null値を入れないように設定|
    |合計金額| sum_price|  int  | not null で　null値を入れないよう |
    |合計金額(税抜)| tax_sum_price | int | not null で　null値を入れないように設定|

- 注文明細テーブル名をorder_detailsで以下の内容で作成<br>

    |論理名|物理名|型|備考|
    |---|---|---|---|
    |注文明細番号|  id  |  int | 主キーを設定<br>AUTO_INCREMENTで自動採番|
    |注文番号|order_id | int | 外部キーの設定|
    |商品ID|product_id | int | 外部キーの設定|
    |数量|amount | int | not null で　null値を入れないように設定 |
    |価格|price | int | not null で　null値を入れないように設定 |

### 商品に以下のデータを入れてください<br>
    
- productsテーブルの中身<br>

    |name(商品名)|price(価格(税抜))|tax(税率)|
    |---|---|---|
    |みかん|100|8|
    |りんご|200|8|
    |ぶどう|1000|8|
    |もも|500|8|
    |すいか|600|8|
    |かき|1000|8|
    |PC|100000|10|
    |イヤホン|3000|10|
    |マウス|5000|10|
    |マイク|10000|10|

### 注文に以下のデータを入れてください<br>
- 注文テーブルの中身<br>
　※1レコード目　西村が2023/7/10にみかん1個、ぶどう2個 <br>
　※2レコード目　西村が2023/7/13にPC、イヤホン、マウス、マイク1個ずつ
  ※3レコード目　園田が2023/7/13にみかん10個、イヤホン2個

|name(購買者)|time(購入日)|sum_price(合計金額)|tax_sum_price(合計金額(税抜))|
|---|---|---|---|
|西村|20230710|2100|2268|
|西村|20230713|118000|129800|
|園田|20230713|7000|7680|

### 注文明細に以下のデータを入れてください<br>

  |order_id(注文番号)|products_id(商品ID)|amount(数量)|price(価格)
  |---|---|---|---|
  |1|1|1|100|
  |1|3|2|2000|
  |1|3|2|2000|
  |2|7|1|100000|
  |2|8|1|3000|
  |2|9|1|5000|
  |2|10|1|10000|
  |3|1|10|1000|
  |3|8|2|6000|
